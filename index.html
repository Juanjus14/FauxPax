<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preguntas Interactivas</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #ffe6e6;
        }
        .container {
            text-align: center;
            background: #ffcccb;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            max-width: 600px;
            width: 90%;
        }
        #situation-text {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #333;
        }
        #question-text {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: #555;
        }
        .buttons {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        button {
            padding: 15px 25px;
            font-size: 1.2rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.3s, background-color 0.3s;
        }
        button:hover {
            transform: scale(1.1);
            background-color: #ffe4e1;
        }
        #yes-button {
            background-color: #ffa726;
            color: #fff;
        }
        #no-button {
            background-color: #90caf9;
        }
        #correct-button {
            background-color: #d1c4e9;
        }
        #incorrect-button {
            background-color: #fff59d;
        }
        .hidden {
            display: none;
        }
        .result-table-container {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #ffcccc;
            font-size: 1.2rem;
        }
        td {
            font-size: 1rem;
        }
        #previous-button {
            position: fixed;
            bottom: 10px;
            right: 10px;
            padding: 10px 20px;
            font-size: 1rem;
            background-color: #ffd480;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        #previous-button:hover {
            background-color: #ffc107;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="situation-screen">
            <p id="situation-text"></p>
            <div id="question-container">
                <p id="question-text"></p>
                <div class="buttons">
                    <button id="yes-button" class="hidden" onclick="handleYes()">SÃ­</button>
                    <button id="no-button" class="hidden" onclick="handleNo()">No</button>
                    <button id="correct-button" class="hidden" onclick="handleCorrect()">â˜€ï¸</button>
                    <button id="incorrect-button" class="hidden" onclick="handleIncorrect()">ğŸŒ™</button>
                </div>
            </div>
        </div>
        <div id="results-prompt" class="hidden">
            <button onclick="showResults()" style="padding: 15px 30px; font-size: 1.2rem; background-color: #b3e6b3; border-radius: 10px;">Mostrar Resultados</button>
        </div>
        <div id="results-screen" class="hidden">
            <h3 style="color: #333;">Resultados</h3>
            <div class="result-table-container">
                <table>
                    <thead>
                        <tr>
                            <th>SituaciÃ³n</th>
                            <th>P1</th>
                            <th>P2</th>
                            <th>P3</th>
                            <th>P4</th>
                        </tr>
                    </thead>
                    <tbody id="results-table"></tbody>
                </table>
            </div>
            <button id="save-results-btn" onclick="submitResults()" style="padding: 15px 30px; font-size: 1.2rem; background-color: #e6b3b3; border-radius: 10px;">
                Guardar Resultados
            </button>
        </div>
    </div>
    <button id="previous-button" onclick="handlePrevious()">Anterior</button>

    <script>
    
        const situations = [
            { text: "Toda la clase participÃ³ en un concurso de cuentos. Ema realmente querÃ­a ganar. Mientras no estaba en la escuela, se anunciaron los resultados del concurso: Alicia fue la ganadora. Al dÃ­a siguiente, Alicia vio a Ema y le dijo: â€œlo siento por tu cuentoâ€.  â€œÂ¿QuÃ© querÃ©s decir?â€ dijo Ema. â€œOh, nadaâ€ dijo Alicia.", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "QuiÃ©n ganÃ³ la competencia?", "Alicia se dio cuenta que Ema no habÃ­a escuchado los resultados de la competencia?"] },
            { text: "Roberto acaba de comenzar en una escuela nueva. Ã‰l dijo a su nuevo amigo, AndrÃ©s, â€œmi mama es una moza en esta escuelaâ€. Luego Clara vino y dijo: â€œOdio las mozas. Son horribles. â€œÂ¿QuerÃ©s que vayamos a jugar por ahÃ­?â€ AndrÃ©s le preguntÃ³ a Clara. â€œNoâ€ contestÃ³ ella â€œno me siento muy bienâ€.", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿QuÃ© trabajo tiene la mamÃ¡ de Roberto?", "Â¿SabÃ­a Clara que la mamÃ¡ de Roberto era moza?"] },
            { text: "Miguel estaba en uno de los baÃ±os de la escuela. JosÃ© y Pedro estaban en las piletas al lado. JosÃ© dijo â€œConoces al chico nuevo de la clase, su nombre es Miguel. No, se ve realmente raro!â€. Miguel saliÃ³ del baÃ±o. Pedro dijo â€œOh, hola Miguel, vas a jugar fÃºtbol ahora?â€.", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿DÃ³nde estaban hablando JosÃ© y Pedro?", "Â¿SabÃ­a JosÃ© que Miguel estaba en los cubÃ­culos?"] },
            { text: "Karina ayudÃ³ a su mamÃ¡ a hacer una torta de manzana para su tÃ­o que los vino a visitar. Ella lo llevÃ³ hasta la cocina. â€œlo hice sÃ³lo para vosâ€ dijo Karina. â€œMmmâ€, contestÃ³ el tÃ­o TomÃ¡s, â€œeso se ve delicioso. Yo adoro las tortas, excepto la de manzana, Â¡por supuesto!â€", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿QuÃ© clase de pastel hizo Karina?", "Â¿SabÃ­a el tÃ­o TomÃ¡s que el pastel era de manzana?"] },
            { text: "Jaime comprÃ³ a Ramiro un aviÃ³n de juguete para su cumpleaÃ±os. Unos meses despuÃ©s, estaban jugando con Ã©l, cuando Jaime accidentalmente lo tirÃ³. â€œNo te preocupesâ€ dijo â€“Ramiro, â€œNunca me gustÃ³ de todos modos. Alguien me lo regalÃ³ para mi cumpleaÃ±osâ€.", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "QuiÃ©n ganÃ³ la competencia?", "Â¿Recuerdas a Ramiro que Jaime le habÃ­a dado el aviÃ³n para su cumpleaÃ±os?"] },
            { text: "SofÃ­a tiene el pelo rubio corto. Estaba en la casa de su tÃ­a Carola. SonÃ³ el timbre. Era MarÃ­a, una vecina. MarÃ­a dijo â€œHolaâ€, luego mirÃ³ a SofÃ­a y dijo â€œOh, creo que no conozco a este pequeÃ±o muchacho. Â¿CÃ³mo te llamÃ¡s?â€ La tÃ­a Carola dijo â€œÂ¿QuiÃ©n quiere una taza de tÃ©?â€", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "En la casa de quien estaba SofÃ­a?", "Â¿SabÃ­a MarÃ­a que SofÃ­a era una niÃ±a?"] },
            { text: "La maestra tenÃ­a algo que contar a su clase, â€œUno de los niÃ±os de nuestra clase, Simon, estÃ¡ muy enfermoâ€ ella dijo. Toda la clase estaba muy triste y sentados quietos cuando una pequeÃ±a niÃ±a, Betty, llegÃ³ tarde. â€œÂ¿Han escuchado mi nuevo chiste del niÃ±o enfermo?â€ ella preguntÃ³. La maestra le dijo â€œSentate y vamos a trabajarâ€.", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿QuÃ© le contÃ³ la maestra a la clase al inicio de la historia?", "SabÃ­a Betty que SimÃ³n estaba enfermo?"] },
            { text: "Tiago estaba en un restaurante. Ã‰l derramÃ³ el cafÃ© en el piso por accidente. Javier era otra persona que estaba en el restaurante, parado al lado de la caja esperando para pagar. Tiago se acercÃ³ a Javier y le dijo â€œLo siento mucho, pero he derramado mi cafÃ©. Â¿PodrÃ­a usted ir a pasar el trapo?â€", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿DÃ³nde ocurriÃ³ la historia?", "SabÃ­a Tiago que Javier era un cliente?"] },
            { text: "Yenny se acababa de mudar a su nueva casa. Ella fue de compras con su mamÃ¡ y comprÃ³ unas cortinas nuevas. Cuando Yenny las acababa de colgar, su mejor amiga Alicia vino y le dijo, â€œOh, esas cortinas son horribles, Â¿las vas a cambiar por unas nuevas?â€. Yenny preguntÃ³ â€œte gusta el resto de mi cuarto?â€", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿QuÃ© acababa de comprar Yenny?", "SabÃ­a Alicia que las cortinas eran nuevas?"] },
            { text: "La madre de Elena estaba haciendo una fiesta sorpresa para el cumpleaÃ±os de Elena. Ella invitÃ³ a Nicole y le dijo, â€œNo le cuentes a nadie, especialmente Elena!â€. El dÃ­a antes de la fiesta Nicole y Elena estaban jugando juntas y Nicole rompiÃ³ su vestido nuevo. â€œOh!â€ dijo Nicole, â€œIba a usar esto para tu fiesta.â€ Â¿QuÃ© fiesta?â€ dijo Elena. â€œVamosâ€ dijo Nicole â€œVamos y veamos si mi mama puede arreglarlo.â€", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿Para quiÃ©n era la fiesta sorpresa?", "Â¿Recuerdas Nicole que la fiesta era sorpresa?"] },
            { text: "Toda la clase participÃ³ de un concurso de poesÃ­a. Juana realmente querÃ­a ganar. Mientras no estaba, se anunciaron los resultados de la competencia. MarÃ­a era la ganadora. Al dÃ­a siguiente, Juana se chocÃ³ con MarÃ­a. MarÃ­a dijo â€œCÃ³mo te sentÃ­s?â€, â€œBien, graciasâ€ dijo Juana. â€œOh, bienâ€ dijo MarÃ­a.", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "QuiÃ©n ganÃ³ el concurso de historias?", "Â¿SabÃ­a MarÃ­a que Juana no habÃ­a escuchado los resultados de la competencia?"] },
            { text: "Diego acababa de comenzar en una escuela nueva. El le dijo a su nuevo amigo, Miguel, â€œMi mamÃ¡ es maestra de esta escuelaâ€. Luego vino JoaquÃ­n. â€œOdio la escuelaâ€ les dijo, â€œes tan pequeÃ±aâ€ â€œQuerÃ©s venir a jugar? Miguel le preguntÃ³ a JoaquÃ­n, â€œNoâ€ contestÃ³ â€œNo me siento bienâ€.", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿QuÃ© trabajo tiene la mamÃ¡ de Diego?", "JoaquÃ­n sabÃ­a que la madre de Diego era maestra?"] },
            { text: "Juan estaba en uno de los baÃ±os de su escuela. Ariel y Franco estaban en las piletas al lado. Ariel dijo â€œConoces al muchacho nuevo de la clase, su nombre es Juan. No es copado?!â€. Juan saliÃ³ del baÃ±o. Franco dijo â€œOh, hola Juan. Â¿Vas a jugar fÃºtbol ahora?â€..", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿DÃ³nde estaban Ariel y Franco mientras hablaban?", "Ariel sabÃ­a que Juan estaba en los cubÃ­culos?"] },
            { text: "Cata ayudÃ³ a su mamÃ¡ a hacer una torta de frutas para su vecino cuando Ã©l vino a visitarlas. Ella lo llevÃ³ afuera de la cocina. â€œLa hice sÃ³lo para vosâ€, dijo Cata. â€œMmmâ€ contestÃ³ su vecino. â€œSe ve buenÃ­sima. Â¡Yo adoro las tortas, especialmente de fruta!", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿QuÃ© clase de pastel habÃ­a hecho Cata?", "Â¿SabÃ­a el vecino que el pastel era de fruta?"] },
            { text: "Santino le comprÃ³ a Roberto un auto nuevo de juguete para su cumpleaÃ±os. Unos meses despuÃ©s, ellos estaban jugando, cuando se le cayÃ³ a Santino. â€œNo te preocupesâ€ dijo Roberto, â€œSÃ³lo fue un accidenteâ€.", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿QuÃ© le dio Santino a Roberto para su cumpleaÃ±os?", "SimÃ³n sabÃ­a que Roberto le habÃ­a dado el juguete para su cumpleaÃ±os?"] },
            { text: "Lilly tenÃ­a cabello corto castaÃ±o. Estaba en la casa de su tÃ­o Teo. SonÃ³ el timbre. Era una vecina. Ella dijo â€œHolaâ€, luego mirÃ³ a Lilly y le dijo â€œOh, creo que no conozco a esta niÃ±ita. Â¿CÃ³mo es tu nombre?â€ El tÃ­o Teo dijo â€œAlguien quiere te?", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿En casa de quiÃ©n estaba Lilly?", "Â¿SabÃ­a la Sra. Suarez que Lilly era una nena?"] },
            { text: "La maestra Sra. Juarez tenÃ­a algo que decir a la clase, â€œUstedes saben que Jorge de nuestra clase, bueno, estÃ¡ seriamente enfermoâ€ ella dijo. Toda la clase estaba muy triste sentados quietos cuando una pequeÃ±a niÃ±a, Andrea, llegÃ³ tarde. â€œAcabo de ir al dentistaâ€ ella dijo. La maestra le dijo â€œSiÃ©ntate y comienza a trabajarâ€.", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿QuÃ© le dijo la maestra a la clase al inicio de la historia?", "Â¿SabÃ­a Andrea que Jorge estaba enfermo?"] },
            { text: "Lucas y Gonzalo estaban tomando un trago en un restaurante. Alan derramÃ³ su bebida en el piso por accidente. El dijo a Gonzalo â€œOh, amigo, DerramÃ© mi bebida!â€ dijo Gonzalo. â€œPedirÃ© otraâ€", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿DÃ³nde ocurriÃ³ la historia?", "Â¿SabÃ­a Lucas que Gonzalo era un cliente?"] },
            { text: "Marina acababa de mudarse a su nueva casa. Marina fue de compras con su mamÃ¡ y comprÃ³ una alfombra nueva para su habitaciÃ³n. Cuando Marina acababa de colocar, su mejor amiga, StefanÃ­a, llegÃ³ y le dijo, â€œOh, tu nueva alfombra es igual que la mÃ­a nuevaâ€ Marina preguntÃ³, â€œTe gusta la casa?â€.", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿QuÃ© acababa de comprar Marina?", "Â¿StefanÃ­a sabÃ­a que la alfombra era nueva?"] },
            { text: "La madre de Ana estaba haciendo una fiesta sorpresa para el cumpleaÃ±os de Ana. Ella invitÃ³ a Valeria y le dijo â€œÂ¡no le digas a nadie, especialmente a Ana!â€. El dÃ­a antes de la fiesta, Ana y Valeria estaban jugando juntas y Ana manchÃ³ su nueva chomba. â€œOh!â€ dijo Ana, â€œmi mamÃ¡ se va a enojarâ€. â€œNo te preocupesâ€ dijo Valeria. â€œVamos a ver si mi mamÃ¡ puede limpiarlaâ€.", questions: ["En la historia alguien dijo algo que no debiera haber dicho?", "Â¿Que dijo que no debiera haber dicho?", "Â¿Para quiÃ©n era la fiesta sorpresa?", "Ana sabÃ­a que habÃ­an planeado una fiesta sorpresa?"] },
            
        ];

        let currentSituation = 0;
        let currentStep = 0;
        const results = [];

        function updateScreen() {
            if (currentSituation < situations.length) {
                const situation = situations[currentSituation];
                document.getElementById("situation-text").textContent = situation.text;
                document.getElementById("question-text").textContent = situation.questions[currentStep];

                if (currentStep === 0) {
                    document.getElementById("yes-button").classList.remove("hidden");
                    document.getElementById("no-button").classList.remove("hidden");
                    document.getElementById("correct-button").classList.add("hidden");
                    document.getElementById("incorrect-button").classList.add("hidden");
                } else {
                    document.getElementById("yes-button").classList.add("hidden");
                    document.getElementById("no-button").classList.add("hidden");
                    document.getElementById("correct-button").classList.remove("hidden");
                    document.getElementById("incorrect-button").classList.remove("hidden");
                }
            } else {
                document.getElementById("situation-screen").classList.add("hidden");
                document.getElementById("results-prompt").classList.remove("hidden");
            }
        }

        function handleYes() {
            recordAnswer("SÃ­");
            currentStep++;
            updateScreen();
        }

        function handleNo() {
            recordAnswer("No");
            currentStep = 4; 
            if (currentStep >= 4) {
                currentStep = 0;
                currentSituation++;
            }
            updateScreen();
        }

        function handleCorrect() {
            recordAnswer("â˜€ï¸");
            currentStep++;
            if (currentStep === 4) {
                currentStep = 0;
                currentSituation++;
            }
            updateScreen();
        }

        function handleIncorrect() {
            recordAnswer("ğŸŒ™");
            currentStep++;
            if (currentStep === 4) {
                currentStep = 0;
                currentSituation++;
            }
            updateScreen();
        }

        function handlePrevious() {
            if (currentStep > 0) {
                currentStep--;
            } else if (currentSituation > 0) {
                currentSituation--;
                currentStep = 3; 
            }
            updateScreen();
        }

        function recordAnswer(answer) {
            if (!results[currentSituation]) results[currentSituation] = [];
            results[currentSituation][currentStep] = answer;
        }

        function showResults() {
            document.getElementById("results-prompt").classList.add("hidden");
            document.getElementById("results-screen").classList.remove("hidden");
            const table = document.getElementById("results-table");
            table.innerHTML = results.map((answers, index) => `
                <tr>
                    <td>SituaciÃ³n ${index + 1}</td>
                    <td>${answers[0] || ""}</td>
                    <td>${answers[1] || ""}</td>
                    <td>${answers[2] || ""}</td>
                    <td>${answers[3] || ""}</td>
                </tr>
            `).join("");
            submitResults();
        }
        function submitResults() {
    const userName = prompt("Ingrese su nombre:");
    if (!userName) return alert("Debe ingresar un nombre.");

    fetch("http://localhost:3000/save-results", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ userName, results })
    })
    .then(response => response.text())
    .then(data => {
        alert("Resultados guardados correctamente.");
        document.getElementById("save-results-btn").style.display = "none"; 
    })
    .catch(error => console.error("Error submitting results:", error));
}

        updateScreen(); 
    </script>
</body>
</html>
